**目标**

* 实现 Host 壳应用（自定义赛博朋克头部、应用中心、懒加载框架）

* 子系统1：色布出入库管理（独立 CRUD，含出库/入库）

* 子系统2：系统配置（读取/修改 system\_config）

* 子系统3：系统管理（系统设置/用户管理/数据备份合一模块）

**目录与清单**

* apps/

  * cloth-io/

    * manifest.json（id: "cloth-io" title: "色布出入库" route: "/app/cloth-io" default: true）

    * src/index.ts（导出 getRoutes()：/cloth/out、/cloth/in；或 mount(router)）

    * src/pages/Out.vue（独立表 stock\_out\_records） src/pages/In.vue（独立表 stock\_in\_records）

  * system-config/

    * manifest.json（id: "system-config" title: "系统配置" route: "/app/system-config"）

    * src/index.ts；src/pages/Config.vue（CRUD system\_config）

  * system-admin/

    * manifest.json（id: "system-admin" title: "系统管理" route: "/app/system-admin"）

    * src/index.ts；src/pages/Users.vue（CRUD users） src/pages/Backup.vue（离线备份/恢复） src/pages/Settings.vue

**壳应用（Host）**

* src/app-shell/

  * AppHub（读取 apps/list 显示卡片、进入时懒加载子系统入口）

  * AppLoader（/app/:id 加载 manifest.entry 并注册路由/呈现根组件）

  * 统一 HeaderBar（已接入窗口控制与赛博朋克风）

* 路由：/hub（应用中心）、/app/:id（子系统承载页）

**主进程与预加载**

* main：扫描 resources/apps/\*/manifest.json 暴露 `apps/list`；提供 file:// 资源路径；保留 SQLite IPC（dbQuery/dbExecute）

* preload：appsAPI.list()、appsAPI.load(entryPath)；windowAPI 窗口控制

**数据与表**

* cloth-io：

  * stock\_out\_records（已实现的独立出库表）

  * stock\_in\_records（入库独立表，字段与出库对应：ship\_date、order\_no、item\_code、customer/supplier、…）

* system-config：复用 system\_config（现有表）

* system-admin：复用 users；备份逻辑复制/恢复 `warehouse.db` 或每应用独立 db（短期复用总库）

**加载与隔离**

* 每子系统构建为独立 chunk，点击后 `import()`加载入口；离开不卸载以提升体验（可配置）

* IPC 按应用前缀控制权限：app:cloth-io、app:system-config、app:system-admin

**默认启动应用**

* 登录后读取 apps 列表，优先 manifest.default=true 的应用（cloth-io）；保留从 system\_config 覆盖默认应用的能力

**性能与维护**

* 代码分割与懒加载、紧凑 UI 覆盖、索引优化（出入库记录表按 order\_no/ship\_date/item\_code/customer/signer 建索引）

* 子系统模板（apps/template/）与约定：入口导出、路由命名、Store 命名空间；版本与迁移在启动时统一检查

**实施步骤**

1. 创建 apps/ 目录与三个子系统骨架及 manifest；将现有“出库记录”迁移到 cloth-io/Out.vue；新增 cloth-io/In.vue 与 stock\_in\_records 表。
2. Host 增加 AppHub 与 AppLoader，完成 /hub 与 /app/:id 路由；预加载实现 appsAPI 与资源路径解析。
3. 主进程扫描 apps，暴露 apps/list；electron-builder 增加 extraResources 打入 apps/
4. 设置登录后默认跳转到 cloth-io；在 AppHub 显示三模块卡片。
5. 完成系统配置与系统管理页面的 CRUD 与备份；联调搜索与表格列压缩。
6. 编写文档与

